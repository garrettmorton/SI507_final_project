# SI507_final_project

This program uses data gathered from the LEGO website online store.  Starting with a webpage with a page with a list of themes, the program scrapes from this page links to a set of pages each of which lists sets sold that are part of that theme.  From each of these list pages, the program scrapes links to pages detailing information about individual LEGO sets.  For each set, it gathers the set's name, product number, number of pieces, price, theme, suggested age range, and up to three tags assigned by LEGO.  This information is then stored in a SQL database.  The relevant parts of the webpage HTML from which this information was gathered is stored as a JSON object in a cache file.

In order to use this program, you will need access to a command line interface and you will need to have a free account with Plotly.  You can sign up for a free account here: https://plot.ly/settings.  After signing up, you will need to write a python file named 'secrets.py' with the following information in it:

	PLOTLY_USERNAME = [your plotly username]
	PLOTLY_API_KEY = [your plotly API key]

The Plotly API key can be generated from your Plotly account page on their website.  This will allow you to view the graphs generated by this program in its analysis of the LEGO set data.

This program works with one custom class, LegoSet, which serves largely as a container for information about individual LEGO sets.  The function scrape_all_data(), which calls two other functions, scrape_set_list() and scrape_set_info(), generates a list of LegoSet objects which can then be passed to populate_db() to construct the SQL database records.  Once the information is stored in the database, the program uses a command line interface that calls three main processing functions--process_size(), process_theme(), and process_tag()--to analyze relationships among database records before graphing those analyses with Plotly.

In order to run the program, simply run 'python lego.py' in your command line.  Once the program is running, you will have the following options of commands.  Below is a list of the commands, and then an explanation of what each one does.

	'help'
	'exit'
	'list'
	'rebuild'
	'size'
	'theme | [option]''
	'tag | [option]'

Help: displays a help message that briefly describes each command and its options.

Exit: quits the program.

List: displays a list of all valid LEGO set themes and tags, for use with the 'theme' and 'tag' commands.

Rebuild: deletes the SQL database, rescrapes the web data, and rebuilds the database from scratch.  Only use the first time the program is run, or to recover from catastrophic database error.

Size: Queries all LEGO sets in the database, then plots a line graph graph with the number of pieces on the x-axis and price-per-piece on the y-axis.

Theme: This command is used to display a variety of graphs comparing information about sets in different themes.  This command has several options available, of which you much select one.  Commands should be formatted with a pipe character separating the main command and its option: 'theme | [option]'.

	Option: price ('theme | price').  This option queries the database for the average price of LEGO sets in each theme and then plots a bar graph with every different theme on the x-axis and the average price of sets in that theme on the y-axis.

	Option: priceper ('theme | priceper').  This option queries the database for the average price-per-piece of sets in each theme and then plots a bar graph with every different theme on the x-axis and the average price-per-piece of sets in that theme on the y-axis.

	Option: pieces ('theme | pieces').  This option queries the database for the average number of pieces of sets in each theme and then plots a bar graph with every different theme on the x-axis and the average number of pieces of sets in that theme on the y-axis.

	Option: number ('theme | number').  This option queries the database for the number of sets in each theme and then plots a bar graph with every different theme on the x-axis and the number of sets in that theme on the y-axis.

	Option: themes ('theme | themes=[theme name 1],[theme name 2],[etc]').  This option allows you to examine the price-per-piece compared to the number of pieces in a set, for one or more themes.  Theme names should be spelled as they are in the 'list' command display, should include any space or punctuation that display shows, and be separated with commas without spaces.  No matter how many themes are indicated, the program will graph a line graph with number of pieces on the x-axis and price-per-piece on the y-axis; each theme will have a differenty colored line.  An example of this command might be 'theme | themes=star wars,harry potter,city'.

Tag: This command is used to display a variety of graphs comparing information about sets in different tags.  This command has several options available, of which you much select one.  Commands should be formatted with a pipe character separating the main command and its option: 'tag | [option]'.

	Option: price ('tag | price').  This option queries the database for the average price of LEGO sets with each tag and then plots a bar graph with every different tag on the x-axis and the average price of sets with that tag on the y-axis.

	Option: priceper ('tag | priceper').  This option queries the database for the average price-per-piece of sets with each tag and then plots a bar graph with every different tag on the x-axis and the average price-per-piece of sets with that tag on the y-axis.

	Option: pieces ('tag | pieces').  This option queries the database for the average number of pieces of sets with each tag and then plots a bar graph with every different tag on the x-axis and the average number of pieces of sets with that tag on the y-axis.

	Option: number ('tag | number').  This option queries the database for the number of sets with each tag and then plots a bar graph with every different tag on the x-axis and the number of sets with that tag on the y-axis.

	Option: tags ('tag | tags=[tag name 1],[tag name 2],[etc]').  This option allows you to examine the price-per-piece compared to the number of pieces in a set, for one or more tags.  Tag names should be spelled as they are in the 'list' command display, should include any space or punctuation that display shows, and be separated with commas without spaces.  No matter how many tags are indicated, the program will graph a line graph with number of pieces on the x-axis and price-per-piece on the y-axis; each tag will have a differenty colored line.  An example of this command might be 'tag | tags=buildings,unikitty!,seasonal'.